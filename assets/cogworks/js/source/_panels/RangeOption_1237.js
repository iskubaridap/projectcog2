define([],function(){
	return [function(require,module,exports){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(_x3,_x4,_x5){var _again=true;_function:while(_again){var object=_x3,property=_x4,receiver=_x5;_again=false;if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{_x3=parent;_x4=property;_x5=receiver;_again=true;desc=parent=undefined;continue _function}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var OptionItem=require("./OptionItem");var getSmartProp=require("../helpers/getSmartProp");var RangeOption=function(_OptionItem){_inherits(RangeOption,_OptionItem);function RangeOption(options){_classCallCheck(this,RangeOption);_get(Object.getPrototypeOf(RangeOption.prototype),"constructor",this).call(this,options);var range=options.range||{};var defaultRange={min:0,max:100,step:1,minLimit:-Infinity,maxLimit:Infinity};this.range=_extends({},defaultRange,range);this.range.decimalPlaces=countDecimals(this.range.step||1);this.units=options.units||[""];this.format=options.format||new RegExp("");this.formatValue=options.formatValue||function(){return""};this.element=$('<div class="option rangeoption">'+'<label class="option-content">'+"<span>"+this._options.label+"</span>"+'<div class="control">'+'<input class="range-slider" type="range" min="'+this.range.min+'" max="'+this.range.max+'" step="'+this.range.step+'">'+'<input type="text" value="" />'+'<span class="warning-badge"></span>'+"</div>"+"</label>"+"</div>");this.textInput=this.element.find("input[type=text]");this.labelSpan=this.element.find("label span");this.control=this.element.find("label .control");this.warningBadge=this.element.find("label .warning-badge").hide();this.slider=this.element.find("> label .range-slider");this._onChangePreviewCallback=this.onChangePreview.bind(this)}_createClass(RangeOption,[{key:"bindEventListeners",value:function bindEventListeners(){this.textInput.off(".rangeoption");this.textInput.on("focusout.rangeoption",this.focusout.bind(this));this.textInput.on("keydown.rangeoption",this.keydownHandler.bind(this));this.textInput.on("input.rangeoption",this.inputHandler.bind(this));this.textInput.on("change.rangeoption",this.onTextChange.bind(this));this.slider.off("input").on("input",this.onSliderInput.bind(this));this.slider.off("change").on("change",this.commitChanges.bind(this))}},{key:"keydownHandler",value:function keydownHandler(e){_get(Object.getPrototypeOf(RangeOption.prototype),"keydownHandler",this).call(this,e);if(e.which==38||e.which==40){var direction=e.which==38?1:-1;if(/\d+/.test(e.target.value)){var pos=e.target.selectionStart;var oldLength=e.target.value.length;var newValue=e.target.value.replace(/(-\d+\.\d+|\d+\.\d+|-\d+|\d+)(?:vw|vh|vmin|vmax|px|pt|pc|ex|em|rem|ch|cm|mm|in|\b)\b/g,function(match,num,offset){if(pos<offset||pos>offset+match.length){return match}var numb=Number(num)+direction;var suffix=match.replace(num,"");if(e.ctrlKey){numb=Number(num)+direction*100}else if(e.shiftKey){numb=Number(num)+direction*10}else if(e.altKey){numb=(Number(num)*10+direction)/10}if(numb!=Math.round(numb)){return numb.toFixed(1)+suffix}return numb+suffix});this.val(newValue);var newLength=e.target.value.length;this.onChangePreview();var offset=Math.min(pos+newLength-oldLength,e.target.value.length);e.target.setSelectionRange(offset,offset);e.preventDefault()}}}},{key:"onSliderInput",value:function onSliderInput(e){var val=e.target.value;var min=this.slider[0].min;var max=this.slider[0].max;var percentage=(val-min)*100/(max-min);var value=percentage/100*(this.range.max-this.range.min);this.updateSlider(value);this.val(value+this.getUnit(e.target.value));this.onChangePreview()}},{key:"onTextChange",value:function onTextChange(e){var value=!isNaN(parseFloat(e.target.value))?parseFloat(e.target.value):"";if(value){value=Math.min(value,this.range.maxLimit);value=Math.max(value,this.range.minLimit)}this.val(value+this.getUnit(e.target.value))}},{key:"inputHandler",value:function inputHandler(){this.scheduleOnChangePreview(100)}},{key:"getUnit",value:function getUnit(value){if(value==="")return"";var unitRegex=new RegExp(this.units.join("|"),"g");var matchedUnits=value.match(unitRegex);return matchedUnits?matchedUnits[0]:this.getCurrentUnit()}},{key:"getCurrentUnit",value:function getCurrentUnit(){return this.currentUnit||this.getDefaultUnit()}},{key:"getDefaultUnit",value:function getDefaultUnit(){return this.units[0]||""}},{key:"getDecimalPlaces",value:function getDecimalPlaces(){return this.range.decimalPlaces}},{key:"formatInputValue",value:function formatInputValue(value){if(value==="")return value;var unit=this.getUnit(value.toString());var formatted=parseFloat(value).toFixed(this.getDecimalPlaces());return formatted.replace(/\.0*$/,"")+unit}},{key:"commitChanges",value:function commitChanges(){this.clearChangePreview();_get(Object.getPrototypeOf(RangeOption.prototype),"commitChanges",this).call(this)}},{key:"discardChanges",value:function discardChanges(){_get(Object.getPrototypeOf(RangeOption.prototype),"discardChanges",this).call(this);this.val(this.getValue());this.onChangePreview()}},{key:"onChangePreview",value:function onChangePreview(){this.updateSlider(this.val());if(this._options.onChangePreview){this._options.onChangePreview(this.val())}}},{key:"clearChangePreview",value:function clearChangePreview(){if(this._options.onChangePreview){this._options.onChangePreview()}}},{key:"scheduleOnChangePreview",value:function scheduleOnChangePreview(){var time=arguments.length<=0||arguments[0]===undefined?20:arguments[0];clearTimeout(this._onChangePreviewTimer);this._onChangePreviewTimer=setTimeout(this._onChangePreviewCallback,time)}},{key:"destructor",value:function destructor(){if(this.isVisible()&&this.val()!=this.getValue()){try{this.changeHandler()}catch(e){}}}},{key:"val",value:function val(v){if(v!==undefined){v=this.formatInputValue(v);this.textInput.val(v);return}return this.textInput.val()}},{key:"focusout",value:function focusout(){try{this.changeHandler()}catch(e){return false}}},{key:"updateSlider",value:function updateSlider(){var val=arguments.length<=0||arguments[0]===undefined?0:arguments[0];val=parseFloat(val,10);var percentage=val*100/(this.range.max-this.range.min);this.slider.val(val);this.slider.css("backgroundSize",percentage+"% 100%")}},{key:"update",value:function update(){_get(Object.getPrototypeOf(RangeOption.prototype),"update",this).call(this);var currentValue=this.getValue();this.val(currentValue);if(this._options.placeholder!==undefined){this.textInput.attr("placeholder",this.formatInputValue(getSmartProp(this._options.placeholder,"")))}this.warningBadge.hide();if(this._options.badge){var badgeResult=this._options.badge();if(badgeResult&&badgeResult.message){this.warningBadge[0].className="badge "+(badgeResult["class"]||"");this.warningBadge.show().html(badgeResult.content).attr("title",badgeResult.message)}}this.updateSlider(currentValue||this.textInput.attr("placeholder"));this.currentUnit=this.getUnit(currentValue);this.bindEventListeners();return this.element}}]);return RangeOption}(OptionItem);module.exports=RangeOption;function countDecimals(value){if(Math.floor(value)===value)return 0;return value.toString().split(".")[1].length||0}},{"../helpers/getSmartProp":575,"./OptionItem":1229}]
});