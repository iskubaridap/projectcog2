define([],function(){
	return [function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var getSmartProp=require("../helpers/getSmartProp");var setSmartProp=require("../helpers/setSmartProp");var OptionItem=function(){function OptionItem(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,OptionItem);this._options=options;this.element=null;if(this._options.id){
this.id=this._options.id}this._isCurrentlyVisible=true;this.parent=null;this._updateFunc=function(){this.update()}.bind(this)}_createClass(OptionItem,[{key:"show",value:function show(){this._isCurrentlyVisible=true;this.element[0].style.display=""}},{key:"hide",value:function hide(){this._isCurrentlyVisible=false;this.element[0].style.display="none"}},{key:"isVisible",value:function isVisible(){if(this.parent){return this._isCurrentlyVisible&&this.parent.isVisible()}return this._isCurrentlyVisible}},{key:"hasPendingChanges",value:function hasPendingChanges(){return this.getValue()!=this.val()}},{key:"update",value:function update(){if(getSmartProp(this._options.visible,true)){this.show()}else{this.hide()}}},{key:"afterUpdate",value:function afterUpdate(){}},{key:"getOption",value:function getOption(prop){return this._options[prop]}},{key:"setOption",value:function setOption(prop,value){this._options[prop]=value}},{key:"val",value:function val(){}},{key:"keydownHandler",value:function keydownHandler(e){if(e.which==13){this.commitChanges();this.unfocus()}if(e.which==27){this.discardChanges();this.unfocus();app.canvas.schedulePartialUpdate({ui:true})}}},{key:"commitChanges",value:function commitChanges(){if(this._options.onCommit){this._options.onCommit()}try{this.changeHandler()}catch(e){return false}}},{key:"discardChanges",value:function discardChanges(){if(this._options.onDiscard){this._options.onDiscard()}}},{key:"unfocus",value:function unfocus(){this.getField().blur();window.getSelection().removeAllRanges()}},{key:"changeHandler",value:function changeHandler(){var oldValue=this.getValue();var newValue=this.val();if(!this.hasPendingChanges()&&!this._options.resetOnClick){return}var self=this;if(this._options.validation){this._options.validation(newValue)}var op=this.setValueOp(newValue,oldValue);op["do"]();if(this._options.component){this._options.component.update();if(this._options.history){app.context.history.add({name:this._options.history,undo:function undo(){op.undo();self._options.component.update()},redo:function redo(){op["do"]();self.setValue(newValue);self._options.component.update()}})}}if(this._options.onChange){this._options.onChange(newValue,oldValue)}}},{key:"getValue",value:function getValue(){if(this._options.valueOp){return this._options.valueOp()}return getSmartProp(this._options.value)}},{key:"setValue",value:function setValue(val){if(this._options.valueOp){return this._options.valueOp(val)["do"]()}return setSmartProp(this._options.value,val)}},{key:"setValueOp",value:function setValueOp(newValue,oldValue){if(this._options.valueOp){return this._options.valueOp(newValue,oldValue)}var that=this;return{do:function _do(){setSmartProp(that._options.value,newValue)},undo:function undo(){setSmartProp(that._options.value,oldValue)}}}},{key:"getField",value:function getField(){return this.element.find("input")}},{key:"scheduleUpdate",value:function scheduleUpdate(){var time=arguments.length<=0||arguments[0]===undefined?20:arguments[0];clearTimeout(this._updateTimer);this._updateTimer=setTimeout(this._updateFunc,time)}},{key:"visible",get:function get(){return this._options.visible},set:function set(val){return this._options.visible=val}}]);return OptionItem}();module.exports=OptionItem},{"../helpers/getSmartProp":575,"../helpers/setSmartProp":611}]
});