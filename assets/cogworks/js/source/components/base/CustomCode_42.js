define([],function(){
	return [function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(_x2,_x3,_x4){var _again=true;_function:while(_again){var object=_x2,property=_x3,receiver=_x4;_again=false;if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{_x2=parent;_x3=property;_x4=receiver;_again=true;desc=parent=undefined;continue _function}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Component=require("./Component");var sanitizeHTML=require("../../helpers/sanitizeHTML");var setTreeImageOverrides=require("../../helpers/setTreeImageOverrides");var escapeRegexString=require("../../helpers/escapeRegexString");var disableAttribute=require("../../helpers/disableAttribute");var CustomCodeEditor=require("../../editors/CustomCodeEditor");var CustomCode=function(_Component){_inherits(CustomCode,_Component);function CustomCode(){_classCallCheck(this,CustomCode);_get(Object.getPrototypeOf(CustomCode.prototype),"constructor",this).call(this);this.element=$("<div>");this.inline=true;this.value="";this._lastUpdateValue=null;this.defineActions({label:"Edit Code",icon:"code",action:this.startHTMLEditing.bind(this),showInFocusBar:true,showInContextMenu:true,showInApplicationMenu:true})}_createClass(CustomCode,[{key:"initialize",value:function initialize(){var value=arguments.length<=0||arguments[0]===undefined?"<div>Custom Code</div>":arguments[0];this.setValue(value)}},{key:"isChildElementBlacklisted",value:function isChildElementBlacklisted(){return true}},{key:"setValue",value:function setValue(value){this.value=value}},{key:"getValue",value:function getValue(){return this.value}},{key:"onDoubleClick",value:function onDoubleClick(){this.startHTMLEditing()}},{key:"startHTMLEditing",value:function startHTMLEditing(){app.editorPanel.openForEditing(this)}},{key:"createEditor",value:function createEditor(){return new CustomCodeEditor(this)}},{key:"invalidateCache",value:function invalidateCache(){this._lastUpdateValue=null}},{key:"stripImagePaths",value:function stripImagePaths(imagePaths){for(var path in imagePaths){var search=new RegExp(escapeRegexString(path),"g");this.value=this.value.replace(search,imagePaths[path])}}},{key:"findUsedImages",value:function findUsedImages(){var context=this.context();var images=_get(Object.getPrototypeOf(CustomCode.prototype),"findUsedImages",this).call(this);context.matchSrcset(this.value,addSourcePath);context.matchImageURLsInStyle(this.value,addSourcePath);context.matchImageURLsInSrc(this.value,addSourcePath);function addSourcePath(path){var image=context.assets.images.getItemByRelativePath(path);if(image&&!images.includes(image)){images.push(image)}}return images}},{key:"afterUpdate",value:function afterUpdate(){var context=this.context();if(context.isDesign||context.isScreenshot){disableAttribute("autoplay",this.element[0])}_get(Object.getPrototypeOf(CustomCode.prototype),"afterUpdate",this).call(this)}},{key:"update",value:function update(){var context=this.context();if(!context.isDesign&&!context.isScreenshot){return context.createCustomCodePlaceholder(this)}this.beforeUpdate();if(this._lastUpdateValue!=this.value){var sanitized=sanitizeHTML(this.value,context.isDesign);sanitized=context.processUserCode(sanitized);var parsed=$("<div>").html(sanitized||"");if(parsed[0].childNodes.length==1&&parsed[0].children.length==1){parsed=$(parsed[0].firstElementChild)}if(context.isDesign){setTreeImageOverrides(parsed[0],context)}this.element.replaceWith(parsed);this.element=parsed;this._lastUpdateValue=this.value}this.afterUpdate();return this.element}},{key:"serialize",value:function serialize(){var obj=_get(Object.getPrototypeOf(CustomCode.prototype),"serialize",this).call(this);obj.value=this.value;return obj}},{key:"unserialize",value:function unserialize(obj){_get(Object.getPrototypeOf(CustomCode.prototype),"unserialize",this).call(this,obj);this.value=obj.value}},{key:"convertUp",value:function convertUp(){var cc=new CustomCode;cc.initialize();cc.value=this.value;return this.framework().convertUpFromTo(this,cc)}},{key:"domNode",get:function get(){var context=this.context();if(!context.isDesign&&!context.isScreenshot){return context.getCustomCodePlaceholder(this)[0]}return _get(Object.getPrototypeOf(CustomCode.prototype),"domNode",this)}}]);return CustomCode}(Component);CustomCode.prettyName="Custom Code";CustomCode.description="Custom Code is a powerful component which lets you write and edit unrestricted HTML. You can use it to quickly add HTML snippets to your designs and to do things not normally possible in the application. Custom Code is filtered inside the program, but your code is included exactly as is when previewing and exporting.";module.exports=CustomCode},{"../../editors/CustomCodeEditor":531,"../../helpers/disableAttribute":556,"../../helpers/escapeRegexString":561,"../../helpers/sanitizeHTML":606,"../../helpers/setTreeImageOverrides":612,"./Component":39}]
});