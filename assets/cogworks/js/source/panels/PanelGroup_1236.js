define([],function(){
	return [function(require,module,exports){"use strict";var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var resizeHandler=require("../helpers/resizeHandler");var getDimensions=require("../helpers/getDimensions");var PanelGroup=function(){function PanelGroup(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,PanelGroup);this.regularDimensions={};this.collapsedDimensions={};this.children=[];this.selectedPanel=null;this.tabToPanel=new WeakMap;app.on("mousemove",this.mousemove.bind(this));app.on("resize",this.onAppResize.bind(this));this.collapsedElement=$('<div class="panel-group collapsed" />');this.expandedElement=$('<div class="panel-group">\n\t\t\t\t<div class="content"></div>\n\t\t\t</div>');this.content=this.expandedElement.find(".content");this._updateFunc=function(){if(!app.hasActiveContext()){return}this.update()}.bind(this)}_createClass(PanelGroup,[{key:"getWidth",value:function getWidth(){if(this.dimensions.width>this.maxWidth){return Math.max(this.maxWidth,this.minWidth)}return this.dimensions.width||310}},{key:"getHeight",value:function getHeight(){if(this.dimensions.height>this.maxHeight){return Math.max(this.maxHeight,this.minHeight)}return this.dimensions.height||win.height()*.6}},{key:"createResizeHandle",value:function createResizeHandle(){return $('<div class="handle resize-panel-group visible"></div>')}},{key:"createXResizeHandle",value:function createXResizeHandle(){var VerticalPanelContainer=require("./VerticalPanelContainer");var handle=this.createResizeHandle();var type="e";if(this.parent&&this.parent instanceof VerticalPanelContainer&&this.parent.reverse){type="w"}handle.addClass("vertical");handle.data("type",type);return handle}},{key:"createYResizeHandle",value:function createYResizeHandle(){var handle=this.createResizeHandle();var type="s";handle.addClass("horizontal");handle.data("type",type);return handle}},{key:"createXYResizeHandle",value:function createXYResizeHandle(){var VerticalPanelContainer=require("./VerticalPanelContainer");var handle=this.createResizeHandle();var type="se";if(this.parent&&this.parent instanceof VerticalPanelContainer&&this.parent.reverse){type="sw"}handle.addClass("both");handle.data("type",type);return handle}},{key:"activate",value:function activate(){this.parent.activateGroup(this)}},{key:"deactivate",value:function deactivate(){this.parent.deactivateGroup(this)}},{key:"toggle",value:function toggle(){var activate=arguments.length<=0||arguments[0]===undefined?null:arguments[0];if(activate===null){activate=this.isActive()}this.parent.toggleGroup(this,activate)}},{key:"togglePanel",value:function togglePanel(panel){var activate=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(!panel)return;if(activate===null){activate=!panel.isActive()}if(activate){panel.activate()}else{panel.deactivate()}}},{key:"activatePanel",value:function activatePanel(panel){if(!panel){panel=this.children[0]||null;return panel.activate()}this.selectedPanel=panel}},{key:"deactivatePanel",value:function deactivatePanel(panel){if(!panel)return;this.selectedPanel=null}},{key:"isActive",value:function isActive(){return this.parent.isGroupActive(this)}},{key:"isContainerCollapsed",value:function isContainerCollapsed(){return this.parent.isCollapsed()}},{key:"isContainerExpanded",value:function isContainerExpanded(){return!this.isContainerCollapsed()}},{key:"hasSelectedPanel",value:function hasSelectedPanel(){return!!this.selectedPanel}},{key:"isPanelSelected",value:function isPanelSelected(child){return this.hasSelectedPanel()&&this.selectedPanel===child}},{key:"set",value:function set(items){this.children=items}},{key:"has",value:function has(panel){return this.children.indexOf(panel)!==-1}},{key:"findIndexFor",value:function findIndexFor(panel){return this.children.indexOf(panel)}},{key:"add",value:function add(items){if(!Array.isArray(items)){items=[items]}var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=items[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var item=_step.value;item.parent=this;this.children.push(item)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator["return"]){_iterator["return"]()}}finally{if(_didIteratorError){throw _iteratorError}}}if(this.isContainerExpanded()&&!this.hasSelectedPanel()){this.activatePanel()}}},{key:"remove",value:function remove(panel){var index=this.findIndexFor(panel);if(index==-1)return;this.children.splice(index,1);if(panel.isSelected()){this.activatePanel()}return panel}},{key:"empty",value:function empty(){var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=this.children[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var panel=_step2.value;if(panel.destructor){panel.destructor()}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2["return"]){_iterator2["return"]()}}finally{if(_didIteratorError2){throw _iteratorError2}}}this.children=[]}},{key:"get",value:function get(index){return this.children[index]}},{key:"getAll",value:function getAll(){return this.children.slice()}},{key:"bindEventListeners",value:function bindEventListeners(){this.expandedElement.off(".panel-group");this.expandedElement.on("mouseenter.panel-group",this.mouseenterPanel.bind(this));this.expandedElement.on("mouseleave.panel-group",this.mouseleavePanel.bind(this));this.expandedElement.on("click.panel-group",".close",this.onClose.bind(this));this.expandedElement.on("click.panel-group",".tab",this.onTabClick.bind(this));this.expandedElement.on("mousedown.panel-group",".handle.resize-panel-group",this.onResizeStart.bind(this))}},{key:"bindCollapsedEventListeners",value:function bindCollapsedEventListeners(){this.collapsedElement.off(".panel-group");this.collapsedElement.on("click.panel-group",".tab",this.onCollapsedTabClick.bind(this));this.collapsedElement.on("mouseenter.panel-group",this.mouseenterPanel.bind(this));this.collapsedElement.on("mouseleave.panel-group",this.mouseleavePanel.bind(this))}},{key:"dragStart",value:function dragStart(components){this.children.map(function(c){return c.dragStart(components)})}},{key:"dragEnd",value:function dragEnd(components){this.children.map(function(c){return c.dragEnd(components)})}},{key:"mouseenterPanel",value:function mouseenterPanel(){this.isMouseOver=true}},{key:"mouseleavePanel",value:function mouseleavePanel(){this.isMouseOver=false}},{key:"mousemove",value:function mousemove(e){if(this.isMouseOver&&app.isDragging){var tab=e.target.closest(".tab");var panel=this.tabToPanel.get(tab);if(!panel)return;panel.dragOver()}}},{key:"onResizeStart",value:function onResizeStart(e){var _this=this;e.preventDefault();var handle=$(e.target);this.updateDimensionsIfNeeded();var handler=resizeHandler({type:handle.data("type"),dimensions:{width:this.getWidth(),height:this.getHeight(),minWidth:this.minWidth,minHeight:this.minHeight,maxWidth:this.maxWidth,maxHeight:this.maxHeight},onResize:function onResize(_ref){var width=_ref.width;var height=_ref.height;_this.resize({width:width,height:height})},onResizeEnd:function onResizeEnd(){_this.updateDimensions();app.trigger("panel-resize")}})}},{key:"onAppResize",value:function onAppResize(){if(this.canBeResizedVertically()||this.canBeResizedHorizontally()){this.resize({height:this.getHeight()})}}},{key:"resize",value:function resize(dimensions){var width=dimensions.width;var height=dimensions.height;width&&this.expandedElement.width(width);height&&this.expandedElement.height(height)}},{key:"onCollapseStateChange",value:function onCollapseStateChange(){if(this.isContainerCollapsed()){this.deactivate()}else{if(this.selectedPanel){this.selectedPanel.activate()}else{this.activatePanel()}}}},{key:"onTabClick",value:function onTabClick(e){var panel=this.tabToPanel.get(e.target.closest(".tab"));if(!panel.isActive()){this.parent.togglePanel(panel,true);this.parent.scheduleUpdate()}}},{key:"onCollapsedTabClick",value:function onCollapsedTabClick(e){var panel=this.tabToPanel.get(e.target.closest(".tab"));this.parent.togglePanel(panel);this.parent.scheduleUpdate()}},{key:"onClose",value:function onClose(){this.deactivate();this.parent.scheduleUpdate()}},{key:"isLastChild",value:function isLastChild(){return this.parent.findIndexFor(this)===this.parent.length-1}},{key:"canBeResizedHorizontally",value:function canBeResizedHorizontally(){return this.parent.canChildBeResizedHorizontally(this)}},{key:"canBeResizedVertically",value:function canBeResizedVertically(){return this.parent.canChildBeResizedVertically(this)}},{key:"updateDimensions",value:function updateDimensions(){if(this.isActive()){this.dimensions=getDimensions(this.expandedElement[0]);app.persistPanels()}}},{key:"updateDimensionsIfNeeded",value:function updateDimensionsIfNeeded(){if(!this.dimensions.width){this.updateDimensions()}}},{key:"scheduleUpdate",value:function scheduleUpdate(){var time=arguments.length<=0||arguments[0]===undefined?20:arguments[0];clearTimeout(this._updateTimer);this._updateTimer=setTimeout(this._updateFunc,time)}},{key:"renderTabFor",value:function renderTabFor(panel){if(!panel)return;var tab=$("<div>");tab.attr("title",panel.name);tab.addClass("tab "+panel.id+(panel.isActive()?" active":"")+(panel.highlighted?" highlighted":"")+(panel.badge?" has-badge":""));var div=$("<div>");var icon=$("<i>");icon.addClass("material-icons");icon.text(panel.icon);var name=$("<span>");name.text(panel.name);div.append(icon);div.append(name);tab.append(div);this.tabToPanel.set(tab[0],panel);return tab}},{key:"renderTabs",value:function renderTabs(){var tabs=$('<div class="tabs"></div>');var tabScroll=$('<div class="tab-squeeze"></div>');var tabHolder=$('<div class="tab-holder"></div>');var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=this.children[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var panel=_step3.value;tabHolder.append(this.renderTabFor(panel))}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3["return"]){_iterator3["return"]()}}finally{if(_didIteratorError3){throw _iteratorError3}}}tabScroll.append(tabHolder);tabs.append(tabScroll);return tabs}},{key:"updateTabs",value:function updateTabs(){this.expandedElement.find(".tabs").remove();this.expandedElement.prepend(this.renderTabs());this.expandedElement.toggleClass("detached",this.isContainerCollapsed());if(this.isContainerCollapsed()){this.expandedElement.find(".tab-holder").append($('<div class="close"><i class="material-icons">close</i></div>'))}}},{key:"addResizeHandles",value:function addResizeHandles(){var canBeResizedVertically=this.canBeResizedVertically();var canBeResizedHorizontally=this.canBeResizedHorizontally();if(canBeResizedHorizontally){this.expandedElement.append(this.createXResizeHandle())}if(canBeResizedVertically){this.expandedElement.append(this.createYResizeHandle())}if(canBeResizedHorizontally&&canBeResizedVertically){this.expandedElement.append(this.createXYResizeHandle())}}},{key:"removeResizeHandles",value:function removeResizeHandles(){this.expandedElement.find(".handle.resize-panel-group").remove()}},{key:"updateCollapsed",value:function updateCollapsed(){this.collapsedElement.empty();this.collapsedElement.append(this.renderTabs());this.bindCollapsedEventListeners();return this.collapsedElement}},{key:"update",value:function update(){this.content.empty();this.updateTabs();if(this.hasSelectedPanel()){var dimensions=this.parent.getGroupDimensions(this);if(this.isContainerCollapsed()){this.expandedElement.css(_extends({position:"fixed"},dimensions))}else{this.expandedElement.removeAttr("style");if(this.canBeResizedVertically()||this.canBeResizedHorizontally()){this.expandedElement.css(dimensions)}}this.content.append(this.selectedPanel.element).show();this.selectedPanel.update()}this.updateResizeHandles();this.bindEventListeners();return this.expandedElement}},{key:"updateResizeHandles",value:function updateResizeHandles(){this.removeResizeHandles();this.addResizeHandles()}},{key:"unserialize",value:function unserialize(obj){var _this2=this;this.regularDimensions=_extends({},obj.regularDimensions);this.collapsedDimensions=_extends({},obj.collapsedDimensions);obj.children.forEach(function(child){var panel=new(app.getPanelConstructor(child["class"]));panel.unserialize(child);_this2.add(panel)})}},{key:"serialize",value:function serialize(){return{class:this.constructor.name,regularDimensions:this.regularDimensions,collapsedDimensions:this.collapsedDimensions,children:this.children.map(function(child){return child.serialize()})}}},{key:"dimensions",set:function set(dimensions){if(this.isContainerCollapsed()){this.collapsedDimensions=dimensions}else{this.regularDimensions=dimensions}},get:function get(){
return this.isContainerCollapsed()?this.collapsedDimensions:this.regularDimensions}},{key:"minWidth",get:function get(){return 100}},{key:"maxWidth",get:function get(){return this.parent.calcMaxGroupWidth(this)}},{key:"minHeight",get:function get(){return 200}},{key:"maxHeight",get:function get(){return this.parent.calcMaxGroupHeight(this)}},{key:"length",get:function get(){return this.children.length}}]);return PanelGroup}();module.exports=PanelGroup},{"../helpers/getDimensions":569,"../helpers/resizeHandler":603,"./VerticalPanelContainer":1244}]
});