define([],function(){
	return [function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var multipleTreeSelection=require("../helpers/multipleTreeSelection");var getDimensions=require("../helpers/getDimensions");var saveRestoreSelection=require("../helpers/saveRestoreSelection");var Panel=function(){function Panel(){var options=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];_classCallCheck(this,Panel);this.element=$('<div class="panel"></div>');this.content=$('<div class="content"></div>');this.content.appendTo(this.element);this.scrollable=$('<div class="list"></div>');this.scrollable.appendTo(this.content);this.content.prepend('<div class="spinner">\n\t\t\t\t<div class="bounce1"></div>\n\t\t\t\t<div class="bounce2"></div>\n\t\t\t\t<div class="bounce3"></div>\n\t\t\t</div>\n\t\t\t');this.id=options.id;this.name=options.name;this.icon=options.icon;this.emptyMessage=options.emptyMessage||"";this.supportsMultiSelection=false;this._dimensionsCache=null;this.multipleSelectionMap=new WeakMap;this._updateFunc=function(){if(!app.hasActiveContext()){return}this.update()}.bind(this);app.on("resize panel-resize",this.invalidateDimensionsCache.bind(this))}_createClass(Panel,[{key:"highlight",value:function highlight(){this.highlighted=true}},{key:"unhighlight",value:function unhighlight(){if(!this.highlighted)return;this.highlighted=false}},{key:"showBadge",value:function showBadge(){this.badge=true}},{key:"removeBadge",value:function removeBadge(){if(!this.badge)return;this.badge=false}},{key:"activate",value:function activate(){this.parent.activatePanel(this);this.unhighlight();this.removeBadge()}},{key:"deactivate",value:function deactivate(){this.parent.deactivatePanel(this)}},{key:"isSelected",value:function isSelected(){return!!this.parent&&this.parent.isPanelSelected(this)}},{key:"isActive",value:function isActive(){return this.isSelected()&&this.parent.isActive()}},{key:"isMouseOver",value:function isMouseOver(){return app.mousePosition.withinRect(this.dimensions)}},{key:"invalidateDimensionsCache",value:function invalidateDimensionsCache(){this._dimensionsCache=null}},{key:"bindEventListeners",value:function bindEventListeners(){this.scrollable.off("scroll").on("scroll",this.saveScrollPosition.bind(this))}},{key:"dragStart",value:function dragStart(components){}},{key:"dragOver",value:function dragOver(){}},{key:"dragEnd",value:function dragEnd(components){this.unhighlight();this.container.scheduleUpdate()}},{key:"panelReady",value:function panelReady(){this.bindEventListeners();if(this.supportsMultiSelection){app.on("context-changed context-activated",function(){this.clearSelections();this.scheduleUpdate()}.bind(this));app.on("mousedown",this.applicationClick.bind(this))}}},{key:"applicationClick",value:function applicationClick(){if(app.isDialogShown()||app.isContextMenuShown()){return}if(!this.isMouseOver()&&this.hasMultipleSelection()){this.clearSelections();this.scheduleUpdate()}}},{key:"saveScrollPosition",value:function saveScrollPosition(){var that=this;clearTimeout(this.scrollTimeout);this.scrollTimeout=setTimeout(function(){that.storeScrollPosition()},25)}},{key:"storeScrollPosition",value:function storeScrollPosition(){app.settings.optionsScrollTop[this.id]=this.scrollable[0].scrollTop}},{key:"restoreScrollPosition",value:function restoreScrollPosition(){this.scrollable[0].scrollTop=app.settings.optionsScrollTop[this.id]||0}},{key:"clearScrollPosition",value:function clearScrollPosition(){app.settings.optionsScrollTop[this.id]=0}},{key:"containsDomNode",value:function containsDomNode(node){return!!this.element.find(node).length}},{key:"storeSelection",value:function storeSelection(){this.activeNode=document.activeElement;this.selection=saveRestoreSelection.save(this.activeNode)}},{key:"resetSelection",value:function resetSelection(){this.activeNode=null;this.selection=null}},{key:"storeFocusState",value:function storeFocusState(){if(this.containsDomNode(document.activeElement)){this.storeSelection()}}},{key:"restoreFocusState",value:function restoreFocusState(){if(!this.activeNode)return;this.activeNode.focus();saveRestoreSelection.restore(this.activeNode,this.selection);this.resetSelection()}},{key:"hasMultipleSelectionForTree",value:function hasMultipleSelectionForTree(tree){if(!this.multipleSelectionMap.has(tree)){return false}return this.multipleSelectionMap.get(tree).hasSelection()}},{key:"createMultipleSelectionForTree",value:function createMultipleSelectionForTree(tree){return multipleTreeSelection(tree,{rootCanBeSelected:false})}},{key:"getMultipleSelectionForTree",value:function getMultipleSelectionForTree(tree){var multiSelect=null;if(this.multipleSelectionMap.has(tree)){multiSelect=this.multipleSelectionMap.get(tree)}else{multiSelect=this.createMultipleSelectionForTree(tree);this.multipleSelectionMap.set(tree,multiSelect)}return multiSelect}},{key:"clearMultipleSelectionForTree",value:function clearMultipleSelectionForTree(tree){this.multipleSelectionMap["delete"](tree)}},{key:"clearSelections",value:function clearSelections(){this.multipleSelectionMap=new WeakMap}},{key:"hasMultipleSelection",value:function hasMultipleSelection(){return false}},{key:"scheduleUpdate",value:function scheduleUpdate(){var time=arguments.length<=0||arguments[0]===undefined?20:arguments[0];clearTimeout(this._updateTimer);this._updateTimer=setTimeout(this._updateFunc,time)}},{key:"buildPanelContent",value:function buildPanelContent(){}},{key:"afterUpdate",value:function afterUpdate(){this.restoreScrollPosition()}},{key:"update",value:function update(){if(!app.context)return this.element;if(this.isActive()){this.buildPanelContent();this.afterUpdate()}this.bindEventListeners();this.invalidateDimensionsCache();return this.element}},{key:"unserialize",value:function unserialize(obj){}},{key:"serialize",value:function serialize(){return{class:this.constructor.name}}},{key:"container",get:function get(){return this.parent.parent}},{key:"dimensions",get:function get(){if(!this._dimensionsCache){this._dimensionsCache=getDimensions(this.element[0])}return this._dimensionsCache}},{key:"contentDimensions",get:function get(){if(this.content){return getDimensions(this.scrollable[0])}return this.dimensions}}]);return Panel}();module.exports=Panel},{"../helpers/getDimensions":569,"../helpers/multipleTreeSelection":589,"../helpers/saveRestoreSelection":608}]
});